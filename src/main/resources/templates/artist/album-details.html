<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <title>Album Details - RevPlay</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container py-5">

    <div class="card shadow p-4">

        <!-- Album Info -->
        <div class="row">

            <!-- Cover -->
            <!-- Album Cover -->
            <div class="col-md-4 text-center">

                <!-- If cover exists -->
                <img th:if="${album.coverImage != null}"
                     th:src="@{/artist/album/cover/{id}(id=${album.albumId})}"
                     class="img-fluid rounded"
                     style="max-height:250px;" />

                <!-- If no cover -->
                <img th:if="${album.coverImage == null}"
                     th:src="@{/images/album-placeholder.svg}"
                     class="img-fluid rounded"
                     style="max-height:250px;" />

            </div>

            <!-- Album Details -->
            <div class="col-md-8">

                <h2 th:text="${album.albumName}"></h2>

                <p>
                    <strong>Genre:</strong>
                    <span th:text="${album.genre != null ? album.genre : 'Unknown'}"></span>
                </p>

                <p>
                    <strong>Release Year:</strong>
                    <span th:text="${album.releaseDate != null ? #temporals.format(album.releaseDate,'yyyy') : 'N/A'}"></span>
                </p>

                <p>
                    <strong>Total Songs:</strong>
                    <span th:text="${songs.size()}"></span>
                </p>

                <!-- Edit & Delete Buttons -->
                <div class="mt-3 d-flex gap-2">

                    <!-- Edit -->
                    <a th:href="@{/artist/album/edit/{id}(id=${album.albumId})}"
                       class="btn btn-warning">
                        Edit
                    </a>

                    <!-- Delete -->
                    <form th:action="@{/artist/album/delete/{id}(id=${album.albumId})}"
                          method="post"
                          onsubmit="return confirm('Delete this album and all its songs?');">

                        <button type="submit" class="btn btn-danger">
                            Delete
                        </button>
                    </form>

                </div>

            </div>
        </div>

        <hr>

        <!-- Songs Section -->
        <h4>Songs</h4>

        th:if="${songs == null or songs.isEmpty()}"
        <p class="text-muted">No songs in this album.</p>
    </div>

    <table class="table table-hover" th:if="${!songs.isEmpty()}">
        <thead>
        <tr>
            <th>#</th>
            <th>Title</th>
            <th>Plays</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="song, iterStat : ${songs}">
            <td th:text="${iterStat.index + 1}"></td>

            <td>
                <a th:href="@{/artist/song/{id}(id=${song.songId})}"
                   th:text="${song.title}">
                </a>
            </td>

            <td th:text="${song.playCount != null ? song.playCount : 0}"></td>
        </tr>
        </tbody>
    </table>

    <!-- Back Button -->
    <div class="mt-4">
        <a th:href="@{/artist/dashboard}" class="btn btn-secondary">
            Back to Studio
        </a>
    </div>

</div>

</div>

</body>
</html>