<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:cursor="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Artist Studio | RevPlay</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/style.css}">

    <style>
        .dashboard-card {
            background: #ffffff;
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }

        .action-btn {
            border-radius: 50px;
            padding: 10px 30px;
            font-weight: 600;
        }

        .album-img {
            height: 160px;
            object-fit: cover;
            border-radius: 15px;
        }
    </style>
</head>

<body class="bg-light">

<nav class="navbar navbar-expand-lg bg-white border-bottom sticky-top">
    <div class="container">
        <a href="/" class="navbar-brand fw-bold">
            <span style="color:#FF6B00;">REV</span>STUDIO
        </a>

        <div class="ms-auto d-flex gap-3">
            <a href="/" class="nav-link">Exit Studio</a>
            <a href="/profile" class="btn btn-outline-warning rounded-pill px-4">My Account</a>
        </div>
    </div>
</nav>

<main class="container py-5">

    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold">
            Welcome, <span th:text="${artist.artistName}">Artist</span>
        </h2>

        <div class="d-flex gap-3">
            <!-- View Public Profile Button -->
            <a th:href="@{/browse/artist/{id}(id=${artist.artistId})}"
               class="btn btn-outline-warning action-btn">
                üëÅÔ∏è View Public Profile
            </a>

            <!-- Redirect Buttons -->
            <a th:href="@{/artist/song/upload}"
               class="btn btn-warning action-btn">
                Upload Song
            </a>

            <a th:href="@{/artist/album/create}"
               class="btn btn-secondary action-btn">
                Create Album
            </a>

        </div>
    </div>

    <div class="row g-4">

        <!-- SONGS CARD -->
        <div class="col-lg-7">
            <div class="dashboard-card">
                <h4 class="fw-bold mb-4">Your Songs</h4>

                <div th:if="${songs == null or songs.isEmpty()}">
                    <p class="text-muted">No songs uploaded yet.</p>
                </div>

                <table class="table align-middle" th:if="${songs != null}">
                    <thead>
                    <tr>
                        <th>Title</th>
                        <th>Album</th>
                        <th>Plays</th>
                        <th class="text-end">Actions</th>
                    </tr>

                    </thead>
                    <tbody>
                    <tr th:each="song : ${songs}"
                        th:attr="onclick=|window.location.href='/artist/song/${song.songId}'|"
                        style="cursor:pointer;">
                        <td th:text="${song.title}"></td>
                        <td th:text="${song.album != null ? song.album.albumName : 'Single'}"></td>
                        <td th:text="${song.playCount != null ? song.playCount : 0}"></td>

                        <td class="text-end">
                            <a th:href="@{'/artist/song/edit/' + ${song.songId}}"
                               class="btn btn-sm btn-outline-warning rounded-pill">
                                ‚úè Edit
                            </a>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ALBUMS CARD -->
        <div class="col-lg-5">
            <div class="dashboard-card">
                <h4 class="fw-bold mb-4">Your Albums</h4>

                <div th:if="${albums == null or albums.isEmpty()}">
                    <p class="text-muted">No albums created yet.</p>
                </div>

                <div class="row" th:if="${albums != null}">
                    <div class="col-6 mb-4" th:each="album : ${albums}">
                        <a th:href="@{'/artist/album/' + ${album.albumId}}"
                           class="text-decoration-none text-dark">
                            <div class="text-center p-3 border rounded-4 h-100 album-hover">

                                <!-- Album Cover -->
                                <img th:src="${album.coverImage != null}
                        ? @{/artist/album/cover/{id}(id=${album.albumId})}
                        : @{/images/album-placeholder.svg}"
                                     class="img-fluid album-img mb-3"
                                     alt="Album Cover">

                                <!-- Album Name -->
                                <div class="fw-semibold mb-1"
                                     th:text="${album.albumName}"></div>

                                <!-- Genre + Year -->
                                <div class="text-muted small mb-3">
                                    <span th:text="${album.genre != null ? album.genre : 'Unknown'}"></span>
                                    ‚Ä¢
                                    <span th:text="${album.releaseDate != null ? #temporals.format(album.releaseDate, 'yyyy') : 'Year N/A'}"></span>
                                </div>

                                <!-- EDIT BUTTON -->
                                <a th:href="@{'/artist/album/edit/' + ${album.albumId}}"
                                   class="btn btn-sm btn-outline-warning rounded-pill px-3">
                                    ‚úè Edit Album
                                </a>

                            </div>
                        </a>
                    </div>

                </div>

            </div>
        </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>